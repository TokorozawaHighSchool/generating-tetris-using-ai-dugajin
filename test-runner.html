<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ†ãƒˆãƒªã‚¹ ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      min-height: 100vh;
    }
    
    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }
    
    .test-container {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
    }
    
    .test-result {
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 6px;
      border-left: 4px solid;
      font-family: 'Courier New', monospace;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .test-pass {
      background: #d4edda;
      color: #155724;
      border-left-color: #28a745;
    }
    
    .test-fail {
      background: #f8d7da;
      color: #721c24;
      border-left-color: #dc3545;
    }
    
    .test-summary {
      font-size: 20px;
      font-weight: bold;
      margin: 25px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      text-align: center;
    }
    
    .performance-info {
      font-size: 12px;
      color: #666;
      font-style: italic;
    }
    
    .loading {
      text-align: center;
      font-size: 18px;
      color: #666;
      margin: 40px 0;
    }
    
    .test-category {
      font-size: 18px;
      font-weight: bold;
      color: #495057;
      margin: 20px 0 10px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid #e9ecef;
    }
    
    /* éè¡¨ç¤ºã®canvasè¦ç´  */
    #tetris, #next, #score, #restart {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ® ãƒ†ãƒˆãƒªã‚¹ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ</h1>
    <p>ã‚³ãƒ¼ãƒ‰ã®å“è³ªã¨æ©Ÿèƒ½æ€§ã‚’ç¢ºèªä¸­...</p>
  </div>
  
  <div class="loading" id="loading">
    â³ ãƒ†ã‚¹ãƒˆã‚’æº–å‚™ã—ã¦ã„ã¾ã™...
  </div>
  
  <!-- éè¡¨ç¤ºã®ã‚²ãƒ¼ãƒ è¦ç´ ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ -->
  <canvas id="tetris" width="240" height="400"></canvas>
  <canvas id="next" width="80" height="80"></canvas>
  <div id="score">Score: 0</div>
  <button id="restart">å†ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  
  <div id="test-results"></div>
  
  <script>
    // ãƒ†ã‚¹ãƒˆå°‚ç”¨: ã‚²ãƒ¼ãƒ ã®è‡ªå‹•é–‹å§‹ã‚’å®Œå…¨ã«ç„¡åŠ¹åŒ–
    window.DISABLE_AUTO_START = true;
    
    // ãƒ†ãƒˆãƒªã‚¹ã‚³ã‚¢ã‚’èª­ã¿è¾¼ã¿ï¼ˆã‚²ãƒ¼ãƒ ã¯é–‹å§‹ã•ã‚Œãªã„ï¼‰
  </script>
  <script src="tetris.js"></script>
  
  <script>
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã®åˆ¶å¾¡
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
      
      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’æ›´æ–°
      const loading = document.getElementById('loading');
      loading.textContent = 'ğŸ§ª ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...';
      
      // ãƒ†ã‚¹ãƒˆã®é–‹å§‹ã‚’å°‘ã—é…ã‚‰ã›ã¦ã€ã™ã¹ã¦ã®è¦ç´ ãŒæº–å‚™ã•ã‚Œã‚‹ã®ã‚’å¾…ã¤
      setTimeout(() => {
        loading.style.display = 'none';
        
        // ãƒ†ãƒˆãƒªã‚¹ã®ã‚²ãƒ¼ãƒ é–¢æ•°ãŒä½¿ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
        if (typeof createMatrix === 'function') {
          console.log('âœ… ãƒ†ãƒˆãƒªã‚¹é–¢æ•°ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
          loadAndRunTests();
        } else {
          console.error('âŒ ãƒ†ãƒˆãƒªã‚¹é–¢æ•°ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
          document.getElementById('test-results').innerHTML = 
            '<div class="test-result test-fail">âŒ ãƒ†ãƒˆãƒªã‚¹é–¢æ•°ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
        }
      }, 500);
    });
    
    // ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‹•çš„ã«èª­ã¿è¾¼ã‚“ã§å®Ÿè¡Œ
    function loadAndRunTests() {
      const script = document.createElement('script');
      script.src = 'tetris-test.js';
      script.onload = () => {
        console.log('âœ… ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
        // ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§DOMContentLoadedã‚’å¾…ã£ã¦ã„ã‚‹ã®ã§ã€æ‰‹å‹•ã§å®Ÿè¡Œ
        if (typeof testRunner !== 'undefined') {
          setTimeout(() => {
            console.log('ğŸš€ ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™');
            testRunner.runAll();
          }, 100);
        }
      };
      script.onerror = () => {
        console.error('âŒ ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
        document.getElementById('test-results').innerHTML = 
          '<div class="test-result test-fail">âŒ ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
      };
      document.head.appendChild(script);
    }
  </script>
</body>
</html>
